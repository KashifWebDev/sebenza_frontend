<div class="d-flex justify-content-between align-items-center flex-wrap grid-margin">
  <div>
    <h4 class="mb-3 mb-md-0">{{isEditMode ? 'Edit' : 'Add'}} Quote Details</h4>
  </div>
</div>
<div class="container">
  <div class="row">
    <app-css-loader *ngIf="isEditMode && loading"></app-css-loader>
    <div class="col-md-12 grid-margin stretch-card" *ngIf="!loading">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title">Customer Details</h4>
          <form [formGroup]="quoteForm" (ngSubmit)="onSubmit()">
            <form [formGroup]="quoteForm" (ngSubmit)="onSubmit()">
              <div class="row">
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="customer_name" class="form-label">Customer Name</label>
                    <input type="text" class="form-control" id="customer_name" name="customer_name" formControlName="customer_name"
                           [ngClass]="{'is-invalid': formProcessed && form.customer_name.errors}">
                    <div *ngIf="formProcessed && form.customer_name.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="customer_phone" class="form-label">Customer Phone</label>
                    <input type="text" class="form-control" id="customer_phone" name="customer_phone" formControlName="customer_phone"
                           [ngClass]="{'is-invalid': formProcessed && form.customer_phone.errors}">
                    <div *ngIf="formProcessed && form.customer_phone.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="customer_email" class="form-label">Customer Email</label>
                    <input type="email" class="form-control" id="customer_email" name="customer_email" formControlName="customer_email"
                           [ngClass]="{'is-invalid': formProcessed && form.customer_email.errors}">
                    <div *ngIf="formProcessed && form.customer_email.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="customer_country" class="form-label">Shipping Country</label>
                    <input type="text" class="form-control" id="customer_country" name="customer_country" formControlName="customer_country"
                           [ngClass]="{'is-invalid': formProcessed && form.customer_country.errors}">
                    <div *ngIf="formProcessed && form.customer_country.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                    <div *ngIf="formProcessed && !form.customer_country.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="shipping_city" class="form-label">Shipping City</label>
                    <input type="text" class="form-control" id="shipping_city" name="shipping_city" formControlName="shipping_city"
                           [ngClass]="{'is-invalid': formProcessed && form.shipping_city.errors}">
                    <div *ngIf="formProcessed && form.shipping_city.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="shipping_zone" class="form-label">Shipping Zone</label>
                    <input type="text" class="form-control" id="shipping_zone" name="shipping_zone" formControlName="shipping_zone"
                           [ngClass]="{'is-invalid': formProcessed && form.shipping_zone.errors}">
                    <div *ngIf="formProcessed && form.shipping_zone.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-lg-6">
                  <div class="row">
                    <div class="col-lg-12">
                      <div class="mb-3">
                        <label for="shipping_address" class="form-label">Shipping Address</label>
                        <input type="text" class="form-control" id="shipping_address" name="shipping_address" formControlName="shipping_address"
                               [ngClass]="{'is-invalid': formProcessed && form.shipping_address.errors}">
                        <div *ngIf="formProcessed && form.shipping_address.errors?.required" class="invalid-feedback">
                          Required
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="row">
                    <div class="col-lg-12">
                      <div class="mb-3">
                        <label for="exampleInputUsername4" class="form-label">Customer's E-Signature <span class="fst-italic text-muted">*(Optional)</span></label>
                        <input type="file" class="form-control" id="exampleInputUsername4"
                               autocomplete="off" placeholder="Name" formControlName="customer_e_signature" (change)="handleFileInput($event)">
                        <img *ngIf="isEditMode"  alt="Old Image" class="h-50 img-fluid mt-4 w-50">
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <hr>
              <h4 class="card-title">Quote Details</h4>

              <div class="row">
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="title" class="form-label">Quote Title</label>
                    <input type="email" class="form-control" id="title" name="title" formControlName="title"
                           [ngClass]="{'is-invalid': formProcessed && form.title.errors}">
                    <div *ngIf="formProcessed && form.title.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="description" class="form-label">Quote Description</label>
                    <input type="text" class="form-control" id="description" name="description" formControlName="description"
                           [ngClass]="{'is-invalid': formProcessed && form.description.errors}">
                    <div *ngIf="formProcessed && form.description.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                    <div *ngIf="formProcessed && !form.description.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="notes" class="form-label">Quote Notes</label>
                    <input type="email" class="form-control" id="notes" name="notes" formControlName="notes"
                           [ngClass]="{'is-invalid': formProcessed && form.notes.errors}">
                    <div *ngIf="formProcessed && form.notes.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="mb-3">
                    <label for="paymentDate" class="form-label">Payment Date</label>
                    <input type="text" class="form-control" id="paymentDate" name="paymentDate" formControlName="paymentDate"
                           [ngClass]="{'is-invalid': formProcessed && form.paymentDate.errors}">
                    <div *ngIf="formProcessed && form.paymentDate.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                    <div *ngIf="formProcessed && !form.paymentDate.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
              </div>


              <hr>
              <div class="row">
                <div class="col-lg-6">
                  <div class="mb-3">
                    <ng-select
                      [items]="termsConditions"
                      [multiple]=true
                      [closeOnSelect]="false"
                      [searchable]="true"
                      bindLabel="termscondition"
                      placeholder="Select Terms"
                      formControlName="termsconditions">
                    </ng-select>
                    <div *ngIf="formProcessed && form.termsconditions.errors?.required" class="invalid-feedback">
                      Required
                    </div>
                  </div>
                </div>
              </div>

              <div class="text-center">
                <app-loading-button
                  [btnIcon]="isEditMode ? 'edit-3' : 'user-plus'"
                  [btnText]="isEditMode ? 'Edt Quote' : 'Create New Quote'"
                  [loadingText]="isEditMode ? 'Updating Quote...' : 'Creating Quote...'"
                  [isLoading]="formSubmit"></app-loading-button>
                <a routerLink="../" class="btn btn-secondary">Cancel</a>
              </div>
            </form>


          </form>
        </div>
      </div>
    </div>
  </div>
</div>
